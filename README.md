# MalwareClassificationCNN
A pipeline for transforming malware Windows System API Call Streams into feature vectors that are then used to train a 1D CNN that achieves 91% accuracy.  
The full details will be available in a paper posted here at a later date, however below is a description.  
Model Structure:  
![alt text](https://github.com/MattScho/MalwareClassificationCNN/blob/master/model.png "Model Architecture")
1-D convolutional layer: This uses convolutional filters to create a feature map from an input API call stream seen as a vector with 279 channels. 
Average Pooling & Flatten: These two layers flatten the generated feature map using average pooling on segments of length two within the generated feature map. 
Intermediate Dense Layer: A standard feed-forward layer in a deep learning architecture which transforms the generated feature vector using ReLU activation. 
Final Dense Layer: Uses soft max activation to generate a vector that represents the probabilities of the input malware API call stream belonging to each class, each class being statically assigned to a specific index of this probability vector within the training data.   

One can use this model to classify an encoded malware API call stream and the index of the largest probability within the output probability vector will correspond to the predicted class. 

Performance versus standard classification algorithms:
![alt text](https://github.com/MattScho/MalwareClassificationCNN/blob/master/SKLearn_Bar.png "Comparison")

Our model achieves an accuracy of 91.1%, the closest algorithm being a Random Forest Classifier which achieves an accuracy of 89.5%.

